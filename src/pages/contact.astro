---
import Layout from "../layouts/Layout.astro";
import PageHeader from "../components/PageHeader.astro";
import emailjs from "@emailjs/browser";
// import { ContactForm } from "../components/ContactForm";
// const p_k = import.meta.env.PUBLIC_KEY;
// console.log(p_k);
---

<Layout title="contact">
  <PageHeader title="contact" desc="contact us" next="home" prev="faq" />
  <div class="container">
    <section>
      <h3>Returning Patients</h3>
      <p>Follow the link below</p>
      <button>Book Appointment</button>
    </section>
    <section>
      <h3>New Patients</h3>
      <p>
        Please fill out the form below and we will get back to you as soon as
        possible!
      </p>
      <form id="contact-form">
        <input type="text" name="name" placeholder="name" />
        <input type="email" name="email" placeholder="email" />
        <input type="text" name="subject" placeholder="subject" />
        <input type="text" name="message" placeholder="message" />
        <button type="submit">Sumbit</button>
      </form>
    </section>
  </div>
</Layout>
<style>
  .container {
    display: grid;
    grid-template-columns: 1;
    grid-template-rows: 2;
  }

  form {
    display: flex;
    flex-direction: column;
    width: 25%;
  }
  input {
    background: none;
    border: none;
    border-bottom: 1px solid black;
  }
</style>
<script
  type="text/javascript"
  src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"
></script>
<script>
  import emailjs from "@emailjs/browser";

  async function connectToEmailJs() {
    try {
      emailjs.init(import.meta.env.PUBLIC_KEY);
      console.log(emailjs);
    } catch (error) {
      console.error(error);
    }
  }

  connectToEmailJs();

  const contactForm = document.getElementById("contact-form");
  console.log(contactForm);
  contactForm.addEventListener("submit", async (e) => {
    // code fragment
    e.preventDefault();

    emailjs
      .sendForm(
        import.meta.env.PUBLIC_SERVICE,
        import.meta.env.PUBLIC_TEMPLATE,
        e.target as HTMLFormElement
      )
      .then(
        function (response) {
          console.log("SUCCESS!", response.status, response.text);
        },
        function (error) {
          console.log("FAILED...", error);
        }
      );
    contactForm.requestFullscreen();
  });
</script>
